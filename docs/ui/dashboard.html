---
layout: null
permalink: /ui/dashboard.html
---
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OR × AI Research Intelligence</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/wordcloud@1.2.2/src/wordcloud2.js"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            navy: '#1E3A8A',
            primary: '#2563EB',
            emerging: '#0891B2',
            growing: '#059669',
            stable: '#4F46E5',
            declining: '#EA580C',
            'must-read': '#DC2626',
            'changes': '#7C3AED',
            'discuss': '#2563EB',
          }
        }
      }
    }
  </script>
  <style>
    [x-cloak] { display: none !important; }
    .tab-btn { @apply px-4 py-1.5 rounded-full text-sm font-medium whitespace-nowrap transition-colors; }
    .tab-btn.active { @apply bg-blue-600 text-white; }
    .tab-btn:not(.active) { @apply text-gray-600 hover:bg-gray-100; }
    .badge { @apply inline-flex items-center px-2 py-0.5 rounded-full text-xs font-bold uppercase tracking-wide; }
    .chip  { @apply inline-flex items-center px-2 py-0.5 rounded text-xs font-medium; }
    .score-high { color: #059669; }
    .score-mid  { color: #D97706; }
    .score-low  { color: #6B7280; }
    .card { @apply bg-white rounded-xl border border-gray-200 p-4 hover:shadow-md transition-shadow; }
    .section-label { @apply text-xs font-bold uppercase tracking-widest text-gray-400 mb-1; }
    .drawer-section { @apply mb-4 pb-4 border-b border-gray-100 last:border-0; }
    /* Score ring */
    .score-ring { @apply inline-flex flex-col items-center; }
    .score-ring .val { @apply text-lg font-extrabold leading-none; }
    .score-ring .lbl { @apply text-[10px] text-gray-400 uppercase tracking-wider; }
    /* Table */
    th { @apply px-3 py-2 text-left text-xs font-bold uppercase tracking-wider text-gray-500 bg-gray-50 cursor-pointer select-none whitespace-nowrap; }
    th:hover { @apply bg-gray-100; }
    td { @apply px-3 py-2 text-sm text-gray-700 align-top; }
    tr:hover td { @apply bg-blue-50; }
  </style>
</head>
<body class="bg-gray-50 min-h-screen" x-data="dashboard()" x-init="init()" x-cloak>

  <!-- ═══════════════════════════════════════════════ HEADER ═══ -->
  <header class="sticky top-0 z-40 text-white" style="background:linear-gradient(135deg,#1E3A8A,#2563EB)">
    <div class="max-w-screen-xl mx-auto px-4 py-3">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-3">
          <div class="w-9 h-9 rounded-lg bg-white/20 flex items-center justify-center font-black text-sm">RI</div>
          <div>
            <h1 class="font-bold text-base leading-tight">OR &times; AI Research Intelligence</h1>
            <p class="text-blue-200 text-xs" x-text="snapshot ? 'Updated ' + (snapshot.last_update_by_category ? Object.values(snapshot.last_update_by_category).filter(Boolean).sort().reverse()[0] : '') : 'Loading...'"></p>
          </div>
        </div>
        <a href="../index.html" class="text-blue-200 hover:text-white text-xs hidden sm:block">← Living Review</a>
      </div>

      <!-- Stat chips -->
      <div class="flex flex-wrap gap-2 mt-2" x-show="snapshot">
        <span class="badge bg-white/15 text-white" x-text="(snapshot?.total_papers ?? '—') + ' papers'"></span>
        <span class="badge bg-white/15 text-white" x-text="(snapshot?.total_fronts ?? '—') + ' fronts'"></span>
        <span class="badge bg-white/15 text-white" x-text="(snapshot?.total_bridges ?? '—') + ' bridges'"></span>
        <span class="badge bg-red-500/80 text-white" x-text="(snapshot?.must_read_count ?? '—') + ' must-read'"></span>
        <span class="badge bg-teal-400/80 text-white" x-text="(snapshot?.emerging_fronts_count ?? '—') + ' emerging'"></span>
        <span class="badge bg-white/15 text-white" x-text="(snapshot?.last_7d_papers ?? '—') + ' new (7d)'"></span>
      </div>

      <!-- Category mini-bars -->
      <div class="grid grid-cols-3 gap-2 mt-2" x-show="snapshot">
        <template x-for="cat in (data?.meta?.categories ?? [])" :key="cat">
          <div class="bg-white/10 rounded-lg px-2 py-1 text-center">
            <div class="text-white font-bold text-sm" x-text="snapshot?.by_category?.[cat]?.papers ?? 0"></div>
            <div class="text-blue-200 text-[10px] leading-tight truncate" x-text="catShort(cat)"></div>
          </div>
        </template>
      </div>
    </div>
  </header>

  <!-- ═══════════════════════════════════════════════ TAB NAV ═══ -->
  <nav class="sticky top-[108px] z-30 bg-white border-b border-gray-200 shadow-sm">
    <div class="max-w-screen-xl mx-auto px-4">
      <div class="flex gap-1 overflow-x-auto py-2 scrollbar-hide">
        <button @click="setTab('priority')"   :class="activeTab==='priority'   ? 'active' : ''" class="tab-btn">Priority Feed</button>
        <button @click="setTab('fronts')"     :class="activeTab==='fronts'     ? 'active' : ''" class="tab-btn">Research Fronts</button>
        <button @click="setTab('bridges')"    :class="activeTab==='bridges'    ? 'active' : ''" class="tab-btn">Bridge Papers</button>
        <button @click="setTab('genealogy')"  :class="activeTab==='genealogy'  ? 'active' : ''" class="tab-btn">Framework Genealogy</button>
        <template x-for="cat in (data?.meta?.categories ?? [])" :key="cat">
          <button @click="setTab('cat_' + catKey(cat))" :class="activeTab==='cat_' + catKey(cat) ? 'active' : ''" class="tab-btn" x-text="catShort(cat)"></button>
        </template>
      </div>
    </div>
  </nav>

  <!-- Loading / Error -->
  <div x-show="loading" class="flex items-center justify-center min-h-64">
    <div class="text-center text-gray-400">
      <div class="w-10 h-10 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin mx-auto mb-3"></div>
      <p class="text-sm">Loading research data…</p>
    </div>
  </div>
  <div x-show="error && !loading" class="max-w-screen-xl mx-auto px-4 py-8 text-center text-red-600">
    <p class="font-bold">Failed to load dashboard data</p>
    <p class="text-sm mt-1" x-text="error"></p>
    <p class="text-xs text-gray-400 mt-2">Run <code>python src/scripts/export_dashboard_data.py</code> then serve docs/ locally.</p>
  </div>

  <!-- ═══════════════════════════════════════════════ MAIN ═══ -->
  <main class="max-w-screen-xl mx-auto px-4 py-5" x-show="!loading && !error">

    <!-- ── TAB 1: Priority Feed ──────────────────────────────── -->
    <div x-show="activeTab==='priority'">
      <!-- Filters -->
      <div class="flex flex-wrap gap-2 mb-4">
        <input x-model="pSearch" type="search" placeholder="Search title, brief, method…" class="flex-1 min-w-[200px] border border-gray-300 rounded-lg px-3 py-1.5 text-sm focus:ring-2 focus:ring-blue-500 outline-none">
        <select x-model="pCat" class="border border-gray-300 rounded-lg px-2 py-1.5 text-sm">
          <option value="all">All categories</option>
          <template x-for="cat in (data?.meta?.categories ?? [])" :key="cat"><option :value="cat" x-text="catShort(cat)"></option></template>
        </select>
        <select x-model="pSig" class="border border-gray-300 rounded-lg px-2 py-1.5 text-sm">
          <option value="all">All significance</option>
          <option value="must_read">Must-Read only</option>
          <option value="changes_thinking">Changes Thinking</option>
          <option value="team_discussion">Team Discussion</option>
        </select>
        <select x-model="pStatus" class="border border-gray-300 rounded-lg px-2 py-1.5 text-sm">
          <option value="all">All front status</option>
          <option value="emerging">Emerging</option>
          <option value="growing">Growing</option>
          <option value="stable">Stable</option>
          <option value="declining">Declining</option>
        </select>
        <span class="self-center text-xs text-gray-400" x-text="filteredPapers.length + ' papers'"></span>
      </div>

      <!-- Cards -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-3">
        <template x-for="(p, idx) in filteredPapers.slice(0, pShowCount)" :key="p.arxiv_id">
          <div class="card cursor-pointer" @click="openDrawer(p)">
            <!-- Badges row -->
            <div class="flex flex-wrap gap-1 mb-2">
              <span class="badge bg-blue-600 text-white">#<span x-text="idx+1"></span></span>
              <template x-if="p.significance?.must_read"><span class="badge bg-red-100 text-red-700">Must-Read</span></template>
              <template x-if="p.significance?.changes_thinking"><span class="badge bg-purple-100 text-purple-700">Changes Thinking</span></template>
              <template x-if="p.significance?.team_discussion"><span class="badge bg-blue-100 text-blue-700">Discuss</span></template>
              <span class="badge ml-auto" :class="scoreClass(p.priority_score)" x-text="'Priority ' + p.priority_score + '/10'"></span>
            </div>
            <!-- MPI row -->
            <div class="flex gap-3 mb-2">
              <div class="score-ring"><span class="val" :class="scoreColor(p.relevance?.methodological)" x-text="p.relevance?.methodological ?? '—'"></span><span class="lbl">M</span></div>
              <div class="score-ring"><span class="val" :class="scoreColor(p.relevance?.problem)"        x-text="p.relevance?.problem ?? '—'"></span><span class="lbl">P</span></div>
              <div class="score-ring"><span class="val" :class="scoreColor(p.relevance?.inspirational)"  x-text="p.relevance?.inspirational ?? '—'"></span><span class="lbl">I</span></div>
              <template x-if="p.front_status">
                <span class="badge ml-2 self-center" :style="'background:' + statusBg(p.front_status) + ';color:white'" x-text="p.front_status"></span>
              </template>
            </div>
            <!-- Title -->
            <a :href="p.arxiv_url" target="_blank" @click.stop class="font-semibold text-gray-900 hover:text-blue-600 text-sm leading-snug block mb-1" x-text="p.title"></a>
            <!-- Meta -->
            <p class="text-xs text-gray-400 mb-2">
              <span x-text="p.published_date"></span>
              <template x-if="p.affiliations"> · <span x-text="p.affiliations"></span></template>
            </p>
            <!-- Brief -->
            <p class="text-xs text-gray-600 leading-relaxed line-clamp-3 mb-2" x-text="p.brief"></p>
            <!-- Tags -->
            <div class="flex flex-wrap gap-1">
              <template x-for="m in (p.tags?.methods ?? []).slice(0,3)" :key="m">
                <span class="chip bg-blue-50 text-blue-700" x-text="m"></span>
              </template>
              <template x-for="pr in (p.tags?.problems ?? []).slice(0,2)" :key="pr">
                <span class="chip bg-gray-100 text-gray-600" x-text="pr"></span>
              </template>
              <template x-if="p.artifacts?.code_url">
                <a :href="p.artifacts.code_url" target="_blank" @click.stop class="chip bg-green-50 text-green-700 ml-auto">Code ↗</a>
              </template>
            </div>
          </div>
        </template>
      </div>

      <!-- Load more -->
      <div class="text-center mt-4" x-show="filteredPapers.length > pShowCount">
        <button @click="pShowCount += 20" class="px-6 py-2 bg-blue-600 text-white rounded-lg text-sm hover:bg-blue-700">
          Load more (<span x-text="filteredPapers.length - pShowCount"></span> remaining)
        </button>
      </div>
      <p x-show="filteredPapers.length === 0" class="text-center text-gray-400 py-12">No papers match the current filters.</p>
    </div>

    <!-- ── TAB 2: Research Fronts ────────────────────────────── -->
    <div x-show="activeTab==='fronts'">
      <div class="flex flex-wrap gap-2 mb-4">
        <input x-model="fSearch" type="search" placeholder="Search front name or summary…" class="flex-1 min-w-[200px] border border-gray-300 rounded-lg px-3 py-1.5 text-sm focus:ring-2 focus:ring-blue-500 outline-none">
        <select x-model="fCat" class="border border-gray-300 rounded-lg px-2 py-1.5 text-sm">
          <option value="all">All categories</option>
          <template x-for="cat in (data?.meta?.categories ?? [])" :key="cat"><option :value="cat" x-text="catShort(cat)"></option></template>
        </select>
        <select x-model="fStatus" class="border border-gray-300 rounded-lg px-2 py-1.5 text-sm">
          <option value="all">All statuses</option>
          <option value="emerging">Emerging</option>
          <option value="growing">Growing</option>
          <option value="stable">Stable</option>
          <option value="declining">Declining</option>
          <option value="merged">Merged</option>
          <option value="split">Split</option>
        </select>
        <span class="self-center text-xs text-gray-400" x-text="filteredFronts.length + ' fronts'"></span>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-3">
        <template x-for="front in filteredFronts" :key="front.front_id">
          <div class="card flex flex-col">
            <!-- Status + metrics -->
            <div class="flex items-center gap-2 mb-2">
              <span class="badge text-white" :style="'background:' + statusBg(front.status)" x-text="front.status"></span>
              <span class="text-xs text-gray-500"><span x-text="front.size"></span> papers</span>
              <span class="text-xs text-gray-500" x-show="front.internal_density">· density <span x-text="Math.round((front.internal_density ?? 0)*100)"></span>%</span>
              <template x-if="front.growth_rate > 0">
                <span class="text-xs text-green-600 ml-auto">▲ <span x-text="Math.round(front.growth_rate*100)"></span>%</span>
              </template>
            </div>
            <!-- Name -->
            <h3 class="font-semibold text-gray-900 text-sm mb-1" x-text="front.name || front.front_id"></h3>
            <p class="text-xs text-gray-400 mb-2" x-text="catShort(front.category) + ' · ' + front.snapshot_date"></p>
            <!-- Summary -->
            <p class="text-xs text-gray-600 leading-relaxed line-clamp-4 mb-2" x-text="front.summary"></p>
            <!-- Methods -->
            <div class="flex flex-wrap gap-1 mb-2">
              <template x-for="m in (front.dominant_methods ?? []).slice(0,4)" :key="m">
                <span class="chip bg-blue-50 text-blue-700" x-text="m"></span>
              </template>
              <template x-for="pr in (front.dominant_problems ?? []).slice(0,2)" :key="pr">
                <span class="chip bg-gray-100 text-gray-600" x-text="pr"></span>
              </template>
            </div>
            <!-- Top affiliations -->
            <template x-if="front.top_affiliations?.length">
              <p class="text-xs text-gray-400 mb-2" x-text="'Top: ' + front.top_affiliations.slice(0,3).map(a => a[0]).join(', ')"></p>
            </template>
            <!-- Future directions -->
            <template x-if="front.future_directions?.length">
              <div class="mb-2">
                <p class="section-label">Future directions</p>
                <ul class="text-xs text-gray-600 space-y-0.5 list-disc list-inside">
                  <template x-for="dir in front.future_directions.slice(0,3)" :key="dir">
                    <li x-text="dir" class="leading-snug"></li>
                  </template>
                </ul>
              </div>
            </template>
            <!-- Core papers toggle -->
            <button @click="fExpanded = fExpanded === front.front_id ? null : front.front_id"
                    class="mt-auto text-xs text-blue-600 hover:underline text-left pt-2">
              <span x-text="fExpanded === front.front_id ? '▲ Hide papers' : '▼ Show ' + front.core_papers.length + ' papers'"></span>
            </button>
            <div x-show="fExpanded === front.front_id" class="mt-2 space-y-1">
              <template x-for="pid in front.core_papers" :key="pid">
                <div class="flex items-start gap-1" x-data="{ p: papersById[pid] }">
                  <template x-if="p">
                    <div class="w-full cursor-pointer hover:bg-blue-50 rounded p-1" @click="openDrawer(p)">
                      <span class="text-xs font-medium text-gray-800 line-clamp-1" x-text="p.title"></span>
                      <div class="flex gap-1 mt-0.5">
                        <span class="text-[10px]" :class="scoreColor(p.relevance?.methodological)" x-text="'M='+p.relevance?.methodological"></span>
                        <span class="text-[10px]" :class="scoreColor(p.relevance?.problem)"        x-text="'P='+p.relevance?.problem"></span>
                        <template x-if="p.significance?.must_read"><span class="text-[10px] text-red-600 font-bold">★</span></template>
                      </div>
                    </div>
                  </template>
                  <template x-if="!p">
                    <a :href="'https://arxiv.org/abs/' + pid" target="_blank" class="text-xs text-blue-600 hover:underline" x-text="pid"></a>
                  </template>
                </div>
              </template>
            </div>
          </div>
        </template>
      </div>
      <p x-show="filteredFronts.length === 0" class="text-center text-gray-400 py-12">No fronts match the current filters.</p>
    </div>

    <!-- ── TAB 3: Bridge Papers ──────────────────────────────── -->
    <div x-show="activeTab==='bridges'">
      <div class="flex flex-wrap gap-2 mb-4">
        <input x-model="bSearch" type="search" placeholder="Search paper title or brief…" class="flex-1 min-w-[200px] border border-gray-300 rounded-lg px-3 py-1.5 text-sm focus:ring-2 focus:ring-blue-500 outline-none">
        <select x-model="bCat" class="border border-gray-300 rounded-lg px-2 py-1.5 text-sm">
          <option value="all">All categories</option>
          <template x-for="cat in (data?.meta?.categories ?? [])" :key="cat"><option :value="cat" x-text="catShort(cat)"></option></template>
        </select>
        <select x-model="bVerdict" class="border border-gray-300 rounded-lg px-2 py-1.5 text-sm">
          <option value="all">All verdicts</option>
          <option value="TRUE SYNTHESIS">True Synthesis</option>
          <option value="CITING BRIDGE">Citing Bridge</option>
          <option value="HOME-ANCHORED">Home-Anchored</option>
          <option value="STRUCTURAL">Structural</option>
        </select>
        <div class="flex items-center gap-2">
          <label class="text-xs text-gray-500">Min score</label>
          <input type="range" x-model="bMinScore" min="0" max="1" step="0.05" class="w-24">
          <span class="text-xs text-gray-600 w-8" x-text="parseFloat(bMinScore).toFixed(2)"></span>
        </div>
        <span class="self-center text-xs text-gray-400" x-text="filteredBridges.length + ' bridges'"></span>
      </div>

      <div class="space-y-3">
        <template x-for="b in filteredBridges" :key="b.paper_id + '_' + b.category" x-data="{ p: papersById[b.paper_id] }">
          <div class="card">
            <div class="flex flex-wrap gap-2 mb-2">
              <span class="badge" :class="verdictClass(b.verdict)" x-text="b.verdict"></span>
              <span class="text-xs text-gray-500 self-center">Bridge score <span class="font-bold text-gray-700" x-text="(b.bridge_score ?? 0).toFixed(2)"></span></span>
              <template x-if="p?.significance?.must_read"><span class="badge bg-red-100 text-red-700">Must-Read</span></template>
              <template x-if="p">
                <div class="flex gap-2 ml-auto">
                  <span class="text-xs" :class="scoreColor(p.relevance?.methodological)" x-text="'M='+p.relevance?.methodological"></span>
                  <span class="text-xs" :class="scoreColor(p.relevance?.problem)"        x-text="'P='+p.relevance?.problem"></span>
                  <span class="text-xs" :class="scoreColor(p.relevance?.inspirational)"  x-text="'I='+p.relevance?.inspirational"></span>
                  <span class="text-xs font-bold text-gray-700" x-text="'Priority ' + (p.priority_score ?? '—')"></span>
                </div>
              </template>
            </div>
            <template x-if="p">
              <div>
                <a :href="p.arxiv_url" target="_blank" class="font-semibold text-gray-900 hover:text-blue-600 text-sm leading-snug" x-text="p.title"></a>
                <p class="text-xs text-gray-400 mt-0.5 mb-1"><span x-text="p.published_date"></span> · <span x-text="catShort(p.category)"></span></p>
                <p class="text-xs text-gray-600 line-clamp-2 mb-2" x-text="p.brief"></p>
              </div>
            </template>
            <template x-if="!p">
              <p class="text-sm text-gray-500 mb-2">arxiv:<span x-text="b.paper_id"></span></p>
            </template>
            <!-- Front path -->
            <div class="flex flex-wrap items-center gap-1 text-xs">
              <span class="text-gray-400">Home front:</span>
              <span class="chip bg-indigo-50 text-indigo-700" x-text="frontById[b.home_front_id]?.name || b.home_front_id"></span>
              <span class="text-gray-300 mx-1">→</span>
              <template x-for="fid in (b.connected_fronts ?? [])" :key="fid">
                <span class="chip bg-teal-50 text-teal-700" x-text="frontById[fid]?.name || fid"></span>
              </template>
            </div>
            <template x-if="p">
              <button @click="openDrawer(p)" class="mt-2 text-xs text-blue-600 hover:underline">Open paper details ▼</button>
            </template>
          </div>
        </template>
      </div>
      <p x-show="filteredBridges.length === 0" class="text-center text-gray-400 py-12">No bridge papers match the current filters.</p>
    </div>

    <!-- ── TAB 4: Framework Genealogy ───────────────────────── -->
    <div x-show="activeTab==='genealogy'">
      <div class="flex flex-wrap gap-2 mb-4">
        <input x-model="gSearch" type="search" placeholder="Filter frameworks…" class="flex-1 min-w-[160px] border border-gray-300 rounded-lg px-3 py-1.5 text-sm focus:ring-2 focus:ring-blue-500 outline-none">
        <label class="flex items-center gap-2 text-sm text-gray-600">
          <input type="checkbox" x-model="gActiveOnly" class="rounded"> Active only (30d)
        </label>
      </div>

      <!-- Word cloud -->
      <div class="card mb-4">
        <p class="section-label mb-2">Framework landscape</p>
        <div class="flex gap-4 text-xs text-gray-500 mb-2">
          <span class="flex items-center gap-1"><span class="w-3 h-3 rounded-full inline-block" style="background:#1A5F7A"></span>Active + high must-read</span>
          <span class="flex items-center gap-1"><span class="w-3 h-3 rounded-full inline-block" style="background:#64B5CD"></span>Active</span>
          <span class="flex items-center gap-1"><span class="w-3 h-3 rounded-full inline-block" style="background:#A5D6A7"></span>Inactive</span>
        </div>
        <canvas id="wordcloud-canvas" width="900" height="300" class="w-full rounded-lg" style="background:#F5F7FA"></canvas>
        <p class="text-xs text-gray-400 mt-1">Click a framework to filter the list below</p>
      </div>

      <!-- Summary chips -->
      <div class="flex flex-wrap gap-3 mb-4" x-show="data?.genealogy?.summary">
        <div class="card text-center py-2 px-4 flex-1 min-w-[100px]">
          <div class="text-xl font-extrabold text-blue-600" x-text="data?.genealogy?.summary?.total_frameworks ?? '—'"></div>
          <div class="text-xs text-gray-400">Frameworks</div>
        </div>
        <div class="card text-center py-2 px-4 flex-1 min-w-[100px]">
          <div class="text-xl font-extrabold text-teal-600" x-text="data?.genealogy?.summary?.active_last_30d ?? '—'"></div>
          <div class="text-xs text-gray-400">Active (30d)</div>
        </div>
        <div class="card text-center py-2 px-4 flex-1 min-w-[100px]">
          <div class="text-xl font-extrabold text-green-600" x-text="data?.genealogy?.summary?.root_frameworks ?? '—'"></div>
          <div class="text-xs text-gray-400">Root lineages</div>
        </div>
      </div>

      <!-- Framework tree list -->
      <div class="space-y-2">
        <template x-for="[fw, info] in filteredFrameworks" :key="fw">
          <div class="card">
            <div class="flex items-center gap-2 flex-wrap">
              <span class="font-semibold text-sm text-gray-800" x-text="fw"></span>
              <template x-if="info.is_active"><span class="badge bg-teal-100 text-teal-700">Active</span></template>
              <span class="chip bg-blue-50 text-blue-700" x-text="(info.papers?.length ?? 0) + ' papers'"></span>
              <template x-if="info.must_read_count > 0">
                <span class="chip bg-red-50 text-red-700" x-text="info.must_read_count + ' must-read'"></span>
              </template>
              <template x-if="info.children?.length">
                <span class="text-xs text-gray-400">→ <span x-text="info.children.join(', ')"></span></span>
              </template>
              <span class="ml-auto text-xs text-gray-400" x-show="info.date_range" x-text="info.date_range"></span>
            </div>
          </div>
        </template>
      </div>
      <p x-show="filteredFrameworks.length === 0" class="text-center text-gray-400 py-12">No frameworks match the current filters.</p>
    </div>

    <!-- ── TABS 5-7: Category Tables ─────────────────────────── -->
    <template x-for="cat in (data?.meta?.categories ?? [])" :key="cat">
      <div x-show="activeTab === 'cat_' + catKey(cat)">
        <!-- Filters -->
        <div class="flex flex-wrap gap-2 mb-3">
          <input :x-model="'ts.' + catKey(cat) + '.search'" @input="e => tableState[cat].search = e.target.value" :value="tableState[cat]?.search ?? ''" type="search" placeholder="Search title, author, method…" class="flex-1 min-w-[200px] border border-gray-300 rounded-lg px-3 py-1.5 text-sm focus:ring-2 focus:ring-blue-500 outline-none">
          <select @change="e => tableState[cat].significanceFilter = e.target.value" class="border border-gray-300 rounded-lg px-2 py-1.5 text-sm">
            <option value="all">All significance</option>
            <option value="must_read">Must-Read</option>
            <option value="changes_thinking">Changes Thinking</option>
          </select>
          <select @change="e => tableState[cat].frontStatusFilter = e.target.value" class="border border-gray-300 rounded-lg px-2 py-1.5 text-sm">
            <option value="all">All front status</option>
            <option value="emerging">Emerging</option>
            <option value="growing">Growing</option>
            <option value="stable">Stable</option>
            <option value="declining">Declining</option>
          </select>
          <input @input="e => tableState[cat].methodFilter = e.target.value" :value="tableState[cat]?.methodFilter ?? ''" type="search" placeholder="Method…" class="w-28 border border-gray-300 rounded-lg px-2 py-1.5 text-sm">
          <input @input="e => tableState[cat].problemFilter = e.target.value" :value="tableState[cat]?.problemFilter ?? ''" type="search" placeholder="Problem…" class="w-28 border border-gray-300 rounded-lg px-2 py-1.5 text-sm">
          <span class="self-center text-xs text-gray-400" x-text="getCategoryTableData(cat).length + ' papers'"></span>
        </div>

        <!-- Table -->
        <div class="overflow-x-auto rounded-xl border border-gray-200 bg-white">
          <table class="w-full text-sm border-collapse">
            <thead>
              <tr>
                <th @click="sortTable(cat, 'published_date')" class="w-24">Date <span x-text="sortArrow(cat, 'published_date')"></span></th>
                <th @click="sortTable(cat, 'title')" class="min-w-[200px]">Title <span x-text="sortArrow(cat, 'title')"></span></th>
                <th class="w-32">Authors</th>
                <th @click="sortTable(cat, 'm_score')" class="w-10 text-center">M <span x-text="sortArrow(cat, 'm_score')"></span></th>
                <th @click="sortTable(cat, 'p_score')" class="w-10 text-center">P <span x-text="sortArrow(cat, 'p_score')"></span></th>
                <th @click="sortTable(cat, 'i_score')" class="w-10 text-center">I <span x-text="sortArrow(cat, 'i_score')"></span></th>
                <th @click="sortTable(cat, 'priority_score')" class="w-20 text-center">Priority <span x-text="sortArrow(cat, 'priority_score')"></span></th>
                <th class="w-32">Significance</th>
                <th @click="sortTable(cat, 'front_name')" class="w-36">Front <span x-text="sortArrow(cat, 'front_name')"></span></th>
                <th class="w-40">Methods</th>
                <th class="w-12 text-center">Code</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-100">
              <template x-for="row in getCategoryTableData(cat)" :key="row.arxiv_id">
                <tr class="cursor-pointer" @click="openDrawer(papersById[row.arxiv_id])">
                  <td class="text-xs text-gray-400" x-text="row.published_date"></td>
                  <td>
                    <a :href="row.arxiv_url" target="_blank" @click.stop class="font-medium text-gray-900 hover:text-blue-600 line-clamp-2 text-xs leading-snug" x-text="row.title"></a>
                  </td>
                  <td class="text-xs text-gray-400 truncate max-w-[120px]" x-text="row.authors_short"></td>
                  <td class="text-center font-bold" :class="scoreColor(row.m_score)" x-text="row.m_score"></td>
                  <td class="text-center font-bold" :class="scoreColor(row.p_score)" x-text="row.p_score"></td>
                  <td class="text-center font-bold" :class="scoreColor(row.i_score)" x-text="row.i_score"></td>
                  <td class="text-center">
                    <span class="inline-block px-1.5 py-0.5 rounded text-xs font-bold" :class="scoreClass(row.priority_score)" x-text="row.priority_score"></span>
                  </td>
                  <td>
                    <div class="flex flex-wrap gap-0.5">
                      <template x-if="row.must_read"><span class="badge bg-red-100 text-red-700 text-[10px]">MR</span></template>
                      <template x-if="row.changes_thinking"><span class="badge bg-purple-100 text-purple-700 text-[10px]">CT</span></template>
                      <template x-if="row.team_discussion"><span class="badge bg-blue-100 text-blue-700 text-[10px]">TD</span></template>
                    </div>
                  </td>
                  <td>
                    <template x-if="row.front_name">
                      <span class="chip text-[10px] text-white" :style="'background:' + statusBg(row.front_status)" x-text="truncate(row.front_name, 22)"></span>
                    </template>
                  </td>
                  <td>
                    <div class="flex flex-wrap gap-0.5">
                      <template x-for="m in (row.methods ?? []).slice(0,2)" :key="m">
                        <span class="chip bg-blue-50 text-blue-700 text-[10px]" x-text="m"></span>
                      </template>
                    </div>
                  </td>
                  <td class="text-center">
                    <template x-if="row.code_url">
                      <a :href="row.code_url" target="_blank" @click.stop class="text-green-600 hover:text-green-800 text-sm" title="Code repository">⌨</a>
                    </template>
                  </td>
                </tr>
              </template>
            </tbody>
          </table>
          <p x-show="getCategoryTableData(cat).length === 0" class="text-center text-gray-400 py-8 text-sm">No papers match the current filters.</p>
        </div>
      </div>
    </template>

  </main>

  <!-- ═══════════════════════════════════════════════ DRAWER ═══ -->
  <!-- Backdrop -->
  <div x-show="drawerPaper" x-transition:enter="transition-opacity duration-200" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition-opacity duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" class="fixed inset-0 bg-black/40 z-50" @click="closeDrawer()"></div>

  <!-- Drawer panel -->
  <div x-show="drawerPaper" x-transition:enter="transition-transform duration-300" x-transition:enter-start="translate-x-full" x-transition:enter-end="translate-x-0" x-transition:leave="transition-transform duration-300" x-transition:leave-start="translate-x-0" x-transition:leave-end="translate-x-full" class="fixed right-0 top-0 h-full w-full max-w-2xl bg-white z-50 overflow-y-auto shadow-2xl">
    <template x-if="drawerPaper">
      <div class="p-5">
        <!-- Header -->
        <div class="flex items-start gap-3 mb-4">
          <button @click="closeDrawer()" class="mt-0.5 text-gray-400 hover:text-gray-700 text-xl leading-none flex-shrink-0">&larr;</button>
          <div class="flex-1 min-w-0">
            <div class="flex flex-wrap gap-1 mb-1">
              <template x-if="drawerPaper.significance?.must_read"><span class="badge bg-red-100 text-red-700">Must-Read</span></template>
              <template x-if="drawerPaper.significance?.changes_thinking"><span class="badge bg-purple-100 text-purple-700">Changes Thinking</span></template>
              <template x-if="drawerPaper.significance?.team_discussion"><span class="badge bg-blue-100 text-blue-700">Team Discussion</span></template>
              <span class="badge ml-auto" :class="scoreClass(drawerPaper.priority_score)" x-text="'Priority ' + drawerPaper.priority_score + '/10'"></span>
            </div>
            <h2 class="font-bold text-gray-900 text-base leading-snug" x-text="drawerPaper.title"></h2>
            <p class="text-xs text-gray-400 mt-0.5" x-text="drawerPaper.published_date + ' · ' + (drawerPaper.affiliations || 'Unknown affiliation')"></p>
          </div>
        </div>

        <!-- MPI scores -->
        <div class="flex gap-6 mb-4 p-3 bg-gray-50 rounded-xl">
          <div class="score-ring"><span class="val" :class="scoreColor(drawerPaper.relevance?.methodological)" x-text="drawerPaper.relevance?.methodological ?? '—'"></span><span class="lbl">Methodological</span></div>
          <div class="score-ring"><span class="val" :class="scoreColor(drawerPaper.relevance?.problem)"        x-text="drawerPaper.relevance?.problem ?? '—'"></span><span class="lbl">Problem</span></div>
          <div class="score-ring"><span class="val" :class="scoreColor(drawerPaper.relevance?.inspirational)"  x-text="drawerPaper.relevance?.inspirational ?? '—'"></span><span class="lbl">Inspirational</span></div>
          <div class="ml-auto flex flex-col items-center">
            <span class="text-lg font-extrabold text-blue-600" x-text="drawerPaper.priority_score"></span>
            <span class="text-[10px] text-gray-400 uppercase tracking-wider">Priority</span>
          </div>
        </div>

        <!-- Brief -->
        <div class="drawer-section">
          <p class="section-label">Brief Assessment</p>
          <p class="text-sm text-gray-700 leading-relaxed" x-text="drawerPaper.brief"></p>
          <template x-if="drawerPaper.significance?.reasoning">
            <p class="text-xs text-gray-400 mt-1 italic" x-text="drawerPaper.significance.reasoning"></p>
          </template>
        </div>

        <!-- Problem -->
        <div class="drawer-section" x-show="drawerPaper.problem?.formal_name">
          <p class="section-label">Problem</p>
          <p class="text-sm font-medium text-gray-800" x-text="drawerPaper.problem?.formal_name"></p>
          <div class="flex flex-wrap gap-1 mt-1">
            <span class="chip bg-gray-100 text-gray-600" x-text="drawerPaper.problem?.class"></span>
            <template x-for="prop in (drawerPaper.problem?.properties ?? [])" :key="prop">
              <span class="chip bg-gray-100 text-gray-600" x-text="prop"></span>
            </template>
            <template x-if="drawerPaper.problem?.scale">
              <span class="chip bg-orange-50 text-orange-700" x-text="'Scale: ' + drawerPaper.problem.scale"></span>
            </template>
          </div>
        </div>

        <!-- Methodology -->
        <div class="drawer-section" x-show="drawerPaper.methodology?.core_method">
          <p class="section-label">Methodology</p>
          <p class="text-sm font-medium text-gray-800 mb-1" x-text="drawerPaper.methodology?.core_method"></p>
          <template x-if="drawerPaper.methodology?.novelty_claim">
            <p class="text-xs text-gray-600 italic mb-1" x-text="drawerPaper.methodology.novelty_claim"></p>
          </template>
          <div class="flex flex-wrap gap-1 mt-1">
            <template x-if="drawerPaper.methodology?.llm_role">
              <span class="chip bg-blue-50 text-blue-700" x-text="'LLM role: ' + drawerPaper.methodology.llm_role"></span>
            </template>
            <template x-for="comp in (drawerPaper.methodology?.components ?? []).slice(0,4)" :key="comp">
              <span class="chip bg-gray-100 text-gray-600" x-text="comp"></span>
            </template>
          </div>
        </div>

        <!-- Results -->
        <div class="drawer-section" x-show="drawerPaper.results?.vs_baselines">
          <p class="section-label">Results</p>
          <p class="text-sm text-gray-700" x-text="drawerPaper.results?.vs_baselines"></p>
          <template x-if="drawerPaper.results?.scalability">
            <p class="text-xs text-gray-500 mt-1" x-text="'Scalability: ' + drawerPaper.results.scalability"></p>
          </template>
          <template x-if="drawerPaper.results?.limitations_acknowledged">
            <p class="text-xs text-gray-400 mt-1 italic" x-text="'Limitations: ' + drawerPaper.results.limitations_acknowledged"></p>
          </template>
        </div>

        <!-- Tags -->
        <div class="drawer-section">
          <p class="section-label">Tags</p>
          <div class="flex flex-wrap gap-1">
            <template x-for="m in (drawerPaper.tags?.methods ?? [])" :key="m">
              <span class="chip bg-blue-50 text-blue-700" x-text="m"></span>
            </template>
            <template x-for="pr in (drawerPaper.tags?.problems ?? [])" :key="pr">
              <span class="chip bg-gray-100 text-gray-600" x-text="pr"></span>
            </template>
            <template x-for="ct in (drawerPaper.tags?.contribution_type ?? [])" :key="ct">
              <span class="chip bg-indigo-50 text-indigo-700" x-text="ct"></span>
            </template>
          </div>
        </div>

        <!-- Lineage -->
        <div class="drawer-section" x-show="drawerPaper.lineage?.direct_ancestors?.length || drawerPaper.lineage?.closest_prior_work">
          <p class="section-label">Lineage</p>
          <template x-if="drawerPaper.lineage?.closest_prior_work">
            <p class="text-xs text-gray-600 mb-1">Closest prior: <span class="font-medium" x-text="drawerPaper.lineage.closest_prior_work"></span></p>
          </template>
          <div class="flex flex-wrap gap-1">
            <template x-for="anc in (drawerPaper.lineage?.direct_ancestors ?? [])" :key="anc">
              <a :href="'https://arxiv.org/abs/' + anc" target="_blank" class="chip bg-yellow-50 text-yellow-700 hover:bg-yellow-100" x-text="anc"></a>
            </template>
          </div>
          <template x-if="drawerPaper.lineage?.novelty_type">
            <span class="chip bg-gray-100 text-gray-500 mt-1" x-text="'Novelty: ' + drawerPaper.lineage.novelty_type"></span>
          </template>
        </div>

        <!-- Extensions -->
        <div class="drawer-section" x-show="drawerPaper.extensions?.next_steps?.length || drawerPaper.extensions?.open_weaknesses?.length">
          <p class="section-label">Extensions & Weaknesses</p>
          <template x-if="drawerPaper.extensions?.next_steps?.length">
            <div class="mb-1">
              <p class="text-xs text-gray-400 mb-0.5">Next steps</p>
              <ul class="text-xs text-gray-600 list-disc list-inside space-y-0.5">
                <template x-for="s in drawerPaper.extensions.next_steps" :key="s"><li x-text="s"></li></template>
              </ul>
            </div>
          </template>
          <template x-if="drawerPaper.extensions?.open_weaknesses?.length">
            <div class="mt-1">
              <p class="text-xs text-gray-400 mb-0.5">Open weaknesses</p>
              <ul class="text-xs text-red-600 list-disc list-inside space-y-0.5">
                <template x-for="w in drawerPaper.extensions.open_weaknesses" :key="w"><li x-text="w"></li></template>
              </ul>
            </div>
          </template>
        </div>

        <!-- Artifacts -->
        <div class="drawer-section" x-show="drawerPaper.artifacts?.code_url || drawerPaper.artifacts?.models_released || drawerPaper.artifacts?.new_benchmark">
          <p class="section-label">Artifacts</p>
          <div class="flex flex-wrap gap-2">
            <template x-if="drawerPaper.artifacts?.code_url">
              <a :href="drawerPaper.artifacts.code_url" target="_blank" class="px-3 py-1.5 bg-green-600 text-white rounded-lg text-xs font-medium hover:bg-green-700">Code Repository ↗</a>
            </template>
            <template x-if="drawerPaper.artifacts?.models_released">
              <span class="chip bg-purple-50 text-purple-700">Models released</span>
            </template>
            <template x-if="drawerPaper.artifacts?.new_benchmark">
              <span class="chip bg-orange-50 text-orange-700">New benchmark</span>
            </template>
          </div>
        </div>

        <!-- Footer actions -->
        <div class="flex gap-2 pt-2">
          <a :href="drawerPaper.arxiv_url" target="_blank" class="flex-1 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium text-center hover:bg-blue-700">Open on ArXiv ↗</a>
          <button @click="closeDrawer()" class="px-4 py-2 border border-gray-300 rounded-lg text-sm text-gray-600 hover:bg-gray-50">Close</button>
        </div>
      </div>
    </template>
  </div>

  <!-- ═══════════════════════════════════════════════ ALPINE ═══ -->
  <script>
    document.addEventListener('alpine:init', () => {
      Alpine.data('dashboard', () => ({
        // State
        loading: true,
        error: null,
        data: null,
        allPapers: [],
        allFronts: [],
        allBridges: [],
        snapshot: null,
        activeTab: 'priority',
        drawerPaper: null,

        // Tab 1: Priority
        pSearch: '', pCat: 'all', pSig: 'all', pStatus: 'all', pShowCount: 20,

        // Tab 2: Fronts
        fSearch: '', fCat: 'all', fStatus: 'all', fExpanded: null,

        // Tab 3: Bridges
        bSearch: '', bCat: 'all', bVerdict: 'all', bMinScore: 0,

        // Tab 4: Genealogy
        gSearch: '', gActiveOnly: false, _wcRendered: false,

        // Tabs 5-7: per-category table state
        tableState: {
          'LLMs for Algorithm Design':  { search:'', sortKey:'priority_score', sortDir:'desc', significanceFilter:'all', frontStatusFilter:'all', methodFilter:'', problemFilter:'' },
          'Generative AI for OR':       { search:'', sortKey:'priority_score', sortDir:'desc', significanceFilter:'all', frontStatusFilter:'all', methodFilter:'', problemFilter:'' },
          'OR for Generative AI':       { search:'', sortKey:'priority_score', sortDir:'desc', significanceFilter:'all', frontStatusFilter:'all', methodFilter:'', problemFilter:'' },
        },

        // ── Computed lookups ────────────────────────────────────────
        get papersById() {
          const m = {};
          this.allPapers.forEach(p => { m[p.arxiv_id] = p; });
          return m;
        },
        get frontById() {
          const m = {};
          this.allFronts.forEach(f => { m[f.front_id] = f; });
          return m;
        },

        // ── Filtered getters ────────────────────────────────────────
        get filteredPapers() {
          const q = this.pSearch.toLowerCase();
          return this.allPapers
            .filter(p => {
              if (q && !p.title.toLowerCase().includes(q) &&
                       !String(p.brief || '').toLowerCase().includes(q) &&
                       !(p.tags?.methods ?? []).join(' ').toLowerCase().includes(q) &&
                       !(p.tags?.problems ?? []).join(' ').toLowerCase().includes(q)) return false;
              if (this.pCat !== 'all' && p.category !== this.pCat) return false;
              if (this.pSig === 'must_read' && !p.significance?.must_read) return false;
              if (this.pSig === 'changes_thinking' && !p.significance?.changes_thinking) return false;
              if (this.pSig === 'team_discussion' && !p.significance?.team_discussion) return false;
              if (this.pStatus !== 'all' && p.front_status !== this.pStatus) return false;
              return true;
            })
            .sort((a, b) => b.priority_score - a.priority_score);
        },

        get filteredFronts() {
          const q = this.fSearch.toLowerCase();
          const order = { emerging:0, growing:1, stable:2, declining:3, merged:4, split:5 };
          return this.allFronts
            .filter(f => {
              if (q && !String(f.name||'').toLowerCase().includes(q) &&
                       !String(f.summary||'').toLowerCase().includes(q) &&
                       !(f.dominant_methods??[]).join(' ').toLowerCase().includes(q)) return false;
              if (this.fCat !== 'all' && f.category !== this.fCat) return false;
              if (this.fStatus !== 'all' && f.status !== this.fStatus) return false;
              return true;
            })
            .sort((a, b) => {
              const oa = order[a.status] ?? 9, ob = order[b.status] ?? 9;
              return oa !== ob ? oa - ob : b.size - a.size;
            });
        },

        get filteredBridges() {
          const q = this.bSearch.toLowerCase();
          const minScore = parseFloat(this.bMinScore) || 0;
          return this.allBridges
            .filter(b => {
              if ((b.bridge_score ?? 0) < minScore) return false;
              if (this.bCat !== 'all' && b.category !== this.bCat) return false;
              if (this.bVerdict !== 'all' && b.verdict !== this.bVerdict) return false;
              if (q) {
                const p = this.papersById[b.paper_id];
                if (!p) return false;
                if (!String(p.title||'').toLowerCase().includes(q) && !String(p.brief||'').toLowerCase().includes(q)) return false;
              }
              return true;
            })
            .sort((a, b) => (b.bridge_score ?? 0) - (a.bridge_score ?? 0));
        },

        get filteredFrameworks() {
          const fw = this.data?.genealogy?.frameworks ?? {};
          const q = this.gSearch.toLowerCase();
          return Object.entries(fw).filter(([name, info]) => {
            if (q && !name.toLowerCase().includes(q)) return false;
            if (this.gActiveOnly && !info.is_active) return false;
            return true;
          }).sort((a, b) => (b[1].papers?.length ?? 0) - (a[1].papers?.length ?? 0));
        },

        // ── Category table filter+sort ──────────────────────────────
        getCategoryTableData(cat) {
          const rows = this.data?.category_tables?.[cat] ?? [];
          const state = this.tableState[cat] ?? {};
          const q = (state.search || '').toLowerCase();
          const mf = (state.methodFilter || '').toLowerCase();
          const pf = (state.problemFilter || '').toLowerCase();

          let out = rows.filter(row => {
            if (q && !String(row.title||'').toLowerCase().includes(q) &&
                     !String(row.authors_short||'').toLowerCase().includes(q) &&
                     !(row.methods??[]).join(' ').toLowerCase().includes(q)) return false;
            if ((state.significanceFilter || 'all') === 'must_read' && !row.must_read) return false;
            if ((state.significanceFilter || 'all') === 'changes_thinking' && !row.changes_thinking) return false;
            if ((state.frontStatusFilter || 'all') !== 'all' && row.front_status !== state.frontStatusFilter) return false;
            if (mf && !(row.methods??[]).some(m => m.toLowerCase().includes(mf))) return false;
            if (pf && !(row.problems??[]).some(p => p.toLowerCase().includes(pf))) return false;
            return true;
          });

          const key = state.sortKey || 'priority_score';
          const dir = state.sortDir || 'desc';
          out.sort((a, b) => {
            const va = a[key] ?? '', vb = b[key] ?? '';
            if (typeof va === 'number') return dir === 'desc' ? vb - va : va - vb;
            return dir === 'desc' ? String(vb).localeCompare(String(va)) : String(va).localeCompare(String(vb));
          });
          return out;
        },

        sortTable(cat, key) {
          if (!this.tableState[cat]) return;
          if (this.tableState[cat].sortKey === key) {
            this.tableState[cat].sortDir = this.tableState[cat].sortDir === 'desc' ? 'asc' : 'desc';
          } else {
            this.tableState[cat].sortKey = key;
            this.tableState[cat].sortDir = 'desc';
          }
        },

        sortArrow(cat, key) {
          if (!this.tableState[cat] || this.tableState[cat].sortKey !== key) return '';
          return this.tableState[cat].sortDir === 'desc' ? ' ↓' : ' ↑';
        },

        // ── Helpers ─────────────────────────────────────────────────
        catShort(cat) {
          return { 'LLMs for Algorithm Design': 'LLMs / Algo', 'Generative AI for OR': 'GenAI / OR', 'OR for Generative AI': 'OR / GenAI' }[cat] ?? cat;
        },
        catKey(cat) { return cat.toLowerCase().replace(/[^a-z0-9]+/g, '_'); },
        truncate(s, n) { return s && s.length > n ? s.slice(0, n) + '…' : (s || ''); },

        scoreColor(n) {
          if (n == null) return 'text-gray-400';
          if (n >= 7) return 'score-high';
          if (n >= 5) return 'score-mid';
          return 'score-low';
        },
        scoreClass(n) {
          if (n == null) return 'bg-gray-100 text-gray-500';
          if (n >= 7) return 'bg-green-100 text-green-800';
          if (n >= 5) return 'bg-yellow-100 text-yellow-800';
          return 'bg-gray-100 text-gray-600';
        },
        statusBg(status) {
          return { emerging:'#0891B2', growing:'#059669', stable:'#4F46E5', declining:'#EA580C', merged:'#9333EA', split:'#DB2777' }[status] ?? '#6B7280';
        },
        verdictClass(v) {
          return { 'TRUE SYNTHESIS':'bg-green-100 text-green-800', 'CITING BRIDGE':'bg-blue-100 text-blue-800', 'HOME-ANCHORED':'bg-indigo-100 text-indigo-800', 'STRUCTURAL':'bg-gray-100 text-gray-600' }[v] ?? 'bg-gray-100 text-gray-600';
        },

        // ── Actions ─────────────────────────────────────────────────
        openDrawer(paper) { if (paper) { this.drawerPaper = paper; document.body.style.overflow = 'hidden'; } },
        closeDrawer()     { this.drawerPaper = null; document.body.style.overflow = ''; },

        setTab(id) {
          this.activeTab = id;
          if (id === 'genealogy') this.$nextTick(() => this.renderWordcloud());
        },

        renderWordcloud() {
          if (this._wcRendered) return;
          const canvas = document.getElementById('wordcloud-canvas');
          if (!canvas || !this.data?.genealogy?.wordcloud_data?.length) return;
          const wcData = this.data.genealogy.wordcloud_data
            .filter(d => !this.gActiveOnly || d.is_active);

          WordCloud(canvas, {
            list: wcData.map(d => [d.text, d.weight]),
            weightFactor: size => Math.max(10, size * 5),
            fontFamily: 'system-ui, sans-serif',
            color: (word) => {
              const item = wcData.find(d => d.text === word);
              if (!item) return '#6B7280';
              if (item.is_active && item.must_read_ratio > 0.3) return '#1A5F7A';
              if (item.is_active) return '#0891B2';
              return '#A5D6A7';
            },
            rotateRatio: 0.2,
            backgroundColor: '#F5F7FA',
            click: item => { this.gSearch = item[0]; },
            hover: (item, dimension, event) => { if (item) canvas.style.cursor = 'pointer'; else canvas.style.cursor = 'default'; },
          });
          this._wcRendered = true;
        },

        // ── Init ─────────────────────────────────────────────────────
        async init() {
          try {
            // Data file is one level up from docs/ui/ → docs/dashboard_data.json
            const resp = await fetch('../dashboard_data.json');
            if (!resp.ok) throw new Error(`HTTP ${resp.status} — make sure dashboard_data.json exists at docs/dashboard_data.json`);
            this.data = await resp.json();
            this.allPapers  = this.data.papers  ?? [];
            this.allFronts  = this.data.fronts  ?? [];
            this.allBridges = this.data.bridges ?? [];
            this.snapshot   = this.data.snapshot ?? null;
          } catch (e) {
            this.error = e.message;
          } finally {
            this.loading = false;
          }
        },
      }));
    });
  </script>
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
</body>
</html>
